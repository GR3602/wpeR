<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Streamlined Analysis of Wild Pedigree Data • wpeR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Streamlined Analysis of Wild Pedigree Data">
<meta name="description" content="Provides tools for analyzing pedigree data of wild populations. While primarily designed to process outputs from the COLONY (Jones &amp; Wang (2010) &lt;doi: 10.1111/j.1755-0998.2009.02787.x&gt;) pedigree reconstruction software, it can also accommodate data from other sources. By linking reconstructed pedigrees with genetic sample metadata, wpeR produces spatial and temporal visualizations as well as tabular summaries that support interpretation of family structures and dynamics. The main goal of the package is to provide a solution for the analysis of complex wild pedigree data and to help the user to gain insights into genetic relationships within wild animal populations.">
<meta property="og:description" content="Provides tools for analyzing pedigree data of wild populations. While primarily designed to process outputs from the COLONY (Jones &amp; Wang (2010) &lt;doi: 10.1111/j.1755-0998.2009.02787.x&gt;) pedigree reconstruction software, it can also accommodate data from other sources. By linking reconstructed pedigrees with genetic sample metadata, wpeR produces spatial and temporal visualizations as well as tabular summaries that support interpretation of family structures and dynamics. The main goal of the package is to provide a solution for the analysis of complex wild pedigree data and to help the user to gain insights into genetic relationships within wild animal populations.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">wpeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/wpeR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GR3602/wpeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="wper">wpeR<a class="anchor" aria-label="anchor" href="#wper"></a>
</h1></div>
<p><strong>w</strong>ild <strong>p</strong>edigree <strong>e</strong>xplorer<strong>R</strong> is an R package designed to simplify the analysis of wild pedigree data. The package was primarily developed to work with pedigree data generated by <a href="https://www.zsl.org/about-zsl/resources/software/colony" class="external-link">COLONY</a> pedigree reconstruction software. However, it can also accommodate pedigree data from other sources. By combining the reconstructed pedigree with genetic sample metadata, wpeR creates visual and tabular representations of the pedigree, allowing the user to interpret the pedigree in spatial and temporal terms. The main goal of the package is to provide an efficient solution for the analysis of complex wild pedigree data and to help the user to gain valuable insights into genetic relationships within wild animal populations.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"GR3602/wpeR"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h2>
<ul>
<li>Pedigree import and formatting</li>
<li>Individual observation timeframe identification</li>
<li>Family organization</li>
<li>Temporal pedigree visualization</li>
<li>Geographic pedigree visualization and GIS output</li>
<li>Integration with other R packages</li>
</ul>
</div>
<div class="section level2">
<h2 id="input-data">Input Data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>The wpeR package requires two main input datasets for analysis: <strong>Pedigree</strong> and <strong>Genetic samples metadata</strong>.</p>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="center">Function <br> call <br> order</th>
<th align="center">Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1a</td>
<td align="center"><em>get_colony()</em></td>
<td>Organizes COLONY output</td>
</tr>
<tr class="even">
<td align="center">1b</td>
<td align="center"><em>get_ped()</em></td>
<td>Organizes pedigree data</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center"><em>anim_timespan()</em></td>
<td>Get dates of individuals first and last sample</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center"><em>org_fams()</em></td>
<td>Organizes animals into families and expands pedigree data</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center"><em>plot_table()</em></td>
<td>Prepares pedigree data for plotting and spatial representation</td>
</tr>
<tr class="even">
<td align="center">5.1</td>
<td align="center"><em>ped_satplot()</em></td>
<td>Temporal plot of pedigree</td>
</tr>
<tr class="odd">
<td align="center">5.2</td>
<td align="center"><em>ped_spatial()</em></td>
<td>Get files for spatial representation of pedigree</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="do">####DATA PREPARATION####</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Define the path to the pedigree data file.</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="at">package =</span> <span class="st">"wpeR"</span>), <span class="st">"/wpeR_samplePed"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Retrieve the pedigree data from the get_colony function.</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>ped_colony <span class="ot">&lt;-</span> <span class="fu">get_colony</span>(path, sampledata, <span class="at">rm_obsolete_parents =</span> <span class="cn">TRUE</span>, <span class="at">out =</span> <span class="st">"FamAgg"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co"># Get animal timespan data using the anim_timespan() function.</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>animal_ts <span class="ot">&lt;-</span> <span class="fu">anim_timespan</span>(wolf_samples<span class="sc">$</span>AnimalRef,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>                           wolf_samples<span class="sc">$</span>Date,</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>                           wolf_samples<span class="sc">$</span>SType,</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>                           <span class="at">dead =</span> <span class="fu">c</span>(<span class="st">"Tissue"</span>))</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co"># Add animal timespan to the sampledata</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>sampledata <span class="ot">&lt;-</span> <span class="fu">merge</span>(wolf_samples, animal_ts, <span class="at">by.x =</span> <span class="st">"AnimalRef"</span>, <span class="at">by.y =</span> <span class="st">"ID"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co"># Organize families and expand pedigree data using the org_fams function.</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="do">## families data frame</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>fams <span class="ot">&lt;-</span> <span class="fu">org_fams</span>(ped_colony, sampledata, <span class="at">output =</span> <span class="st">"fams"</span>)</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="do">## extended pedigree data frame</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>ped <span class="ot">&lt;-</span> <span class="fu">org_fams</span>(ped_colony,sampledata, <span class="at">output =</span> <span class="st">"ped"</span>)</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co"># The example show just one family </span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="do">## Prepare data for plotting.</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>pt <span class="ot">&lt;-</span> <span class="fu">plot_table</span>(<span class="at">plot_fams =</span> <span class="dv">1</span>,</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>                 org_tables<span class="sc">$</span>fams,</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>                 org_tables<span class="sc">$</span>ped,</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>                 sampledata,</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>                 <span class="at">deadSample =</span> <span class="fu">c</span>(<span class="st">"Tissue"</span>))</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>                 </span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="do">####VISUALIZATION####                 </span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="do">## Get a temporal pedigree plot.</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="fu">ped_satplot</span>(<span class="at">plottable =</span> pt)</span></code></pre></div>
<div class="float">
<img src="reference/figures/sat_plot_exmpl.png" alt="image"><div class="figcaption">image</div>
</div>
<p><strong>EXAMPLE</strong> Visualization using <a href="https://CRAN.R-project.org/package=kinship2" class="external-link"><code>kinship2</code></a> package</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># optional pedigre plot pedigree plot from kinship2</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="do">### extract parent codes</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>parents1 <span class="ot">=</span> <span class="fu">strsplit</span>(fams[fams<span class="sc">$</span>FamID <span class="sc">==</span> <span class="dv">1</span>,]<span class="sc">$</span>parents, <span class="st">"_"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="do">### filter the family from pedigre</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>Fam1 <span class="ot">=</span> ped[(ped<span class="sc">$</span>FamID <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> ped<span class="sc">$</span>id <span class="sc">%in%</span> parents1),]</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="do">### plot using kinship2 </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">plot</span>(kinship2<span class="sc">::</span><span class="fu">pedigree</span>(Fam1<span class="sc">$</span>id, Fam1<span class="sc">$</span>father, Fam1<span class="sc">$</span>mother, Fam1<span class="sc">$</span>sex))</span></code></pre></div>
<div class="float">
<img src="reference/figures/ks2_pedigree_exmpl.png" alt="image"><div class="figcaption">image</div>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="do">## Create spatial files</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="sc">&lt;!--</span> ps <span class="ot">&lt;-</span> <span class="fu">ped_spatial</span>(pt) <span class="sc">-</span><span class="ot">-&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">summary</span>(ps)</span></code></pre></div>
<table style="border-collapse: collapse; width: 100%; background-color: white;" class="table">
<thead><tr>
<th colspan="2">
Object Name
</th>
<th>
Description
</th>
</tr></thead>
<tbody>
<!-- Rpoints --><tr>
<td>
mother…
</td>
<td rowspan="3">
Rpoints
</td>
<td rowspan="3">
POINT object representing reference samples of each animal. Reference sample for parents is their first sample, reference sample for the offspring is their last sample within the user defined time frame.
</td>
</tr>
<tr>
<td>
father…
</td>
</tr>
<tr>
<td>
offspring…
</td>
</tr>
<!-- MovePoints --><tr>
<td>
mother…
</td>
<td rowspan="3">
MovePoints
</td>
<td rowspan="3">
POINT object representing all samples of a particular animal.
</td>
</tr>
<tr>
<td>
father…
</td>
</tr>
<tr>
<td>
offspring…
</td>
</tr>
<!-- Lines --><tr>
<td>
maternity…
</td>
<td rowspan="2">
Lines
</td>
<td rowspan="2">
LINESTRING object connecting reference samples of mothers or fathers with reference samples of their offspring.
</td>
</tr>
<tr>
<td>
paternity…
</td>
</tr>
<!-- MoveLines --><tr>
<td>
mother…
</td>
<td rowspan="3">
MoveLines
</td>
<td rowspan="3">
LINESTRING object connecting all samples of an individual in chronological order, showcasing the movement or changes in location over time for the specific animal.
</td>
</tr>
<tr>
<td>
father…
</td>
</tr>
<tr>
<td>
offspring…
</td>
</tr>
<!-- MovePolygon --><tr>
<td>
mother…
</td>
<td rowspan="2">
MovePolygon
</td>
<td rowspan="2">
POLYGON object representing a convex hull that encloses all the samples of an individual. It provides a graphical representation of the spatial extent or range covered by the animal based on its sample locations.
</td>
</tr>
<tr>
<td>
father…
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>EXAMPLE</strong> Using spatial files together with <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><code>ggplot2</code></a>, <a href="https://CRAN.R-project.org/package=basemaps" class="external-link"><code>basemaps</code></a> and <a href="https://github.com/yutannihilation/ggsflabel" class="external-link"><code>ggsflabel</code></a> for spatial visualization.</p>
<table class="table">
<colgroup><col width="100%"></colgroup>
<thead><tr class="header">
<th align="center"><img src="reference/figures/ped_spatial_exmpl1.png" alt="image"></th>
</tr></thead>
<tbody><tr class="odd">
<td align="center"><em>Spatial representation using mother/father/offspringRpoints and maternety/paternitylines</em></td>
</tr></tbody>
</table>
<table class="table">
<colgroup><col width="100%"></colgroup>
<thead><tr class="header">
<th align="center"><img src="reference/figures/ped_spatial_exmpl2.png" alt="!image"></th>
</tr></thead>
<tbody><tr class="odd">
<td align="center"><em>Spatial representation using mother/fatherRpoints/MovePoints/MoveLines</em></td>
</tr></tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/GR3602/wpeR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/GR3602/wpeR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing wpeR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tomaz Skrbinsek <br><small class="roles"> Author </small>   </li>
<li>Gregor Simcic <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tomaz Skrbinsek, Gregor Simcic.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
