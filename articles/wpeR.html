<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to wpeR package • wpeR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to wpeR package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wpeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/wpeR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GR3602/wpeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="wpeR_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="wpeR_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="wpeR_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="wpeR_files/leaflet-1.3.1/leaflet.js"></script><link href="wpeR_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="wpeR_files/proj4-2.6.2/proj4.min.js"></script><script src="wpeR_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="wpeR_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="wpeR_files/leaflet-binding-2.2.2/leaflet.js"></script><script src="wpeR_files/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="wpeR_files/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to wpeR package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/GR3602/wpeR/blob/master/vignettes/wpeR.Rmd" class="external-link"><code>vignettes/wpeR.Rmd</code></a></small>
      <div class="d-none name"><code>wpeR.Rmd</code></div>
    </div>

    
    
<p>Welcome to the <strong>wpeR</strong> vignette! <strong>wpeR</strong>
is an R package designed for analyzing wild pedigree data. Pedigree
reconstruction is a powerful tool for understanding the genetic
structure of wild populations, but it can also generate large and
complex datasets that can be difficult to analyze. <strong>wpeR</strong>
provides a streamlined solution for exploring and visualizing this type
of data, allowing the user to gain insights into the genetic
relationships between individuals in wild populations. In this vignette,
we will introduce the main features of <strong>wpeR</strong> and
demonstrate how they can be used to analyze and interpret wild
pedigrees.</p>
<p>To get started install the the latest development of the package from
GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"GR3602/wpeR"</span><span class="op">)</span></span></code></pre></div>
<p>You should be now able to load <strong>wpeR</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gr3602.github.io/wpeR/">wpeR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p><strong>wpeR</strong> works with two main input datasets:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Pedigree</strong></p>
<ol type="a">
<li>
<p><a href="https://www.zsl.org/about-zsl/resources/software/colony" class="external-link">COLONY</a>
pedigree data.The reconstructed pedigree is an output of COLONY software
and is stored in the colony project output folder. The function
<code><a href="../reference/get_colony.html">get_colony()</a></code> automatically reads the pedigree file so you
do not need to import it into the R session.</p>
</li>
<li>
<p>Custom pedigree data. Users can work with pedigree data reconstructed
by any software as long as it follows the formatting rules specified in
the <code><a href="../reference/get_ped.html">get_ped()</a></code> function.</p>
</li>
</ol>
</li>
<li>
<p><strong>Genetic samples metadata</strong>.<br> This dataset
should include information on all genetic samples belonging to the
animals included in the pedigree and must include columns that
describe:</p>
<ul>
<li>Sample unique identifier code.</li>
<li>Date of sample collection in <code>YYYY-MM-DD</code> format.</li>
<li>Identifier code of the particular individual that the sample belongs
to.</li>
<li>Genetic sex coded as <code>M</code> for males, <code>F</code> for
females and <code>NA</code> for unknown sex.</li>
<li>Geographic location from where the sample was collected, as latitude
and longitude in WGS84 coordinate system (EPSG: 4326).</li>
<li>Sample type (eg: scat, urine, tissue)<br>
</li>
</ul>
</li>
</ol>
<p>Correctly formatted genetic samples metadata is crucial for the
proper functioning of <strong>wpeR</strong> functions. To ensure that
your genetic samples metadata conforms to the package’s rules, the
package includes <code><a href="../reference/check_sampledata.html">check_sampledata()</a></code> function. This function
performs a series of checks and validations on your input data to verify
its integrity and compatibility. If all the validations are passed the
<code><a href="../reference/check_sampledata.html">check_sampledata()</a></code> function outputs the sample metadata
data frame that can be seamlessly used in downstream analyses.</p>
<p>An example pedigree and sample metadata (<code>wolf_samples</code>)
is included in this package and this two datasets will be used
throughout this vignette.</p>
<p>To check if the genetic sample metadata is formatted correctly you
can link the columns in the data frame with the parameters of the
<code><a href="../reference/check_sampledata.html">check_sampledata()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampledata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_sampledata.html">check_sampledata</a></span><span class="op">(</span></span>
<span>  Sample <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">Sample</span>,</span>
<span>  Date <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">Date</span>,</span>
<span>  AnimalRef <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">AnimalRef</span>,</span>
<span>  GeneticSex <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">GeneticSex</span>,</span>
<span>  lat <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">lat</span>,</span>
<span>  lng <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">lng</span>,</span>
<span>  SType <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">SType</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If there are no errors or warnings during the execution of the
<code><a href="../reference/check_sampledata.html">check_sampledata()</a></code> function, it indicates that the genetic
sample metadata is correctly formatted. You can use the returned data
frame, in downstream analyses. Example of properly formatted sample
metadata with all required columns looks like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sampledata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sample       Date AnimalRef GeneticSex      lat      lng SType</span></span>
<span><span class="co">#&gt; 1  M10XC 2017-11-16     M10XC          M 45.70766 14.12922  Scat</span></span>
<span><span class="co">#&gt; 2  M0PXH 2017-11-22     M10XC          M 45.71356 14.10497  Scat</span></span>
<span><span class="co">#&gt; 3  M0PFL 2017-12-22     M10XC          M 45.69898 14.07907  Scat</span></span>
<span><span class="co">#&gt; 4  M1J47 2019-08-20     M1J47          M 45.70854 14.09644  Scat</span></span>
<span><span class="co">#&gt; 5  M1HF2 2019-08-31     M1J47          M 45.69930 14.05550  Scat</span></span>
<span><span class="co">#&gt; 6 MSV163 2020-07-17     M1J47          M 45.71804 14.14319  Scat</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-workflow">The workflow<a class="anchor" aria-label="anchor" href="#the-workflow"></a>
</h2>
<p>Since many of the functions in <strong>wpeR</strong> build upon the
results of previous functions, it is recommended to follow a specific
sequence when using the package. Here, we present the optimal workflow
for using <strong>wpeR</strong>.</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="58%">
</colgroup>
<thead><tr class="header">
<th align="center">Function <br> call <br> order</th>
<th align="center">Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1a</td>
<td align="center"><em>get_colony()</em></td>
<td>Organizes COLONY output</td>
</tr>
<tr class="even">
<td align="center">1b</td>
<td align="center"><em>get_ped()</em></td>
<td>Organizes Pedigree Data</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center"><em>anim_timespan()</em></td>
<td>Get dates of individuals first and last sample</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center"><em>org_fams()</em></td>
<td>Organizes animals into families and expands pedigree data</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center"><em>plot_table()</em></td>
<td>Prepares pedigree data for plotting and spatial representation</td>
</tr>
<tr class="even">
<td align="center">5.1</td>
<td align="center"><em>ped_satplot()</em></td>
<td>Temporal plot of pedigree</td>
</tr>
<tr class="odd">
<td align="center">5.2</td>
<td align="center"><em>ped_spatial()</em></td>
<td>Get Files For Spatial Representation Of Pedigree</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="import-the-pedigree">Import the pedigree<a class="anchor" aria-label="anchor" href="#import-the-pedigree"></a>
</h3>
<p><strong>COLONY PEDIGREE DATA</strong></p>
<p>Pedigree reconstructed by COLONY software is imported into the R
session by <code><a href="../reference/get_colony.html">get_colony()</a></code> function. Apart form reading the
colony output file <code><a href="../reference/get_colony.html">get_colony()</a></code> also adds missing parents
to OffspirngID, assigns sex to each animal and adds the probability of
paternity and maternity assignment as calculated by COLONY.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"wpeR"</span><span class="op">)</span>, <span class="st">"/wpeR_samplePed"</span><span class="op">)</span></span>
<span><span class="va">ped_colony</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_colony.html">get_colony</a></span><span class="op">(</span></span>
<span>  colony_project_path <span class="op">=</span> <span class="va">path</span>, </span>
<span>  sampledata <span class="op">=</span>  <span class="va">wolf_samples</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">ped_colony</span><span class="op">)</span></span>
<span><span class="co">#&gt;    ClusterIndex     id father mother sex</span></span>
<span><span class="co">#&gt; 60            1 MSV0T7  M20AM  M273P   1</span></span>
<span><span class="co">#&gt; 61            1 MSV0TJ  M20AM  M273P   2</span></span>
<span><span class="co">#&gt; 62            1 MSV0UL  M20AM  M273P   1</span></span>
<span><span class="co">#&gt; 63            1 MSV0X4  M20AM  M273P   1</span></span>
<span><span class="co">#&gt; 64            1 MSV17F  M20AM  M273P   2</span></span>
<span><span class="co">#&gt; 65            1 MSV1MH  M20AM  M273P   2</span></span></code></pre></div>
<p><strong>CUSTOM PEDIGREE DATA</strong></p>
<p>In cases when the pedigree was not reconstructed with COLONY software
you must use the <code><a href="../reference/get_ped.html">get_ped()</a></code> function. Under the hood the
<code><a href="../reference/get_colony.html">get_colony()</a></code> and <code><a href="../reference/get_ped.html">get_ped()</a></code> are very similar,
the latter having a little less functionalities, because it is primarily
designed so that any pedigree data can be used in downstream analysis.
When using <code><a href="../reference/get_ped.html">get_ped()</a></code> function it is important to note that
the <code>ped</code> parameter (the reconstructed pedigree) has to be
formatted as a basic pedigree with four columns corresponding to
offspring (has to be named OffspringID), father (has to be named
FatherID) and mother (has to be named MotherID). Unknown parents should
be represented by <code>NA</code> values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  OffspringID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"M273P"</span>, <span class="st">"M20AM"</span>, <span class="st">"M2757"</span>, <span class="st">"M2ALK"</span>, <span class="st">"M2ETE"</span>, <span class="st">"M2EUJ"</span>, <span class="st">"MSV00E"</span>,</span>
<span>    <span class="st">"MSV018"</span>, <span class="st">"MSV05L"</span>, <span class="st">"MSV0M6"</span>, <span class="st">"MSV0T4"</span>, <span class="st">"MSV0T7"</span>, <span class="st">"MSV0TJ"</span>, <span class="st">"MSV0UL"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  FatherID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span>,</span>
<span>    <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span>, <span class="st">"M20AM"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  MotherID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"M273P"</span>, <span class="st">"M273P"</span>, <span class="st">"M273P"</span>, <span class="st">"M273P"</span>, <span class="st">"M273P"</span>,</span>
<span>    <span class="st">"M273P"</span>, <span class="st">"M273P"</span>, <span class="st">"M273P"</span>, <span class="st">"M273P"</span>, <span class="st">"M273P"</span>, <span class="st">"M273P"</span>, <span class="st">"M273P"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/get_ped.html">get_ped</a></span><span class="op">(</span></span>
<span>    ped <span class="op">=</span> <span class="va">ped</span>,</span>
<span>    sampledata <span class="op">=</span> <span class="va">wolf_samples</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt;        id father mother sex</span></span>
<span><span class="co">#&gt; 1   M273P   &lt;NA&gt;   &lt;NA&gt;   2</span></span>
<span><span class="co">#&gt; 2   M20AM   &lt;NA&gt;   &lt;NA&gt;   1</span></span>
<span><span class="co">#&gt; 3   M2757  M20AM  M273P   2</span></span>
<span><span class="co">#&gt; 4   M2ALK  M20AM  M273P   2</span></span>
<span><span class="co">#&gt; 5   M2ETE  M20AM  M273P   2</span></span>
<span><span class="co">#&gt; 6   M2EUJ  M20AM  M273P   2</span></span>
<span><span class="co">#&gt; 7  MSV00E  M20AM  M273P   1</span></span>
<span><span class="co">#&gt; 8  MSV018  M20AM  M273P   1</span></span>
<span><span class="co">#&gt; 9  MSV05L  M20AM  M273P   1</span></span>
<span><span class="co">#&gt; 10 MSV0M6  M20AM  M273P   1</span></span>
<span><span class="co">#&gt; 11 MSV0T4  M20AM  M273P   1</span></span>
<span><span class="co">#&gt; 12 MSV0T7  M20AM  M273P   1</span></span>
<span><span class="co">#&gt; 13 MSV0TJ  M20AM  M273P   2</span></span>
<span><span class="co">#&gt; 14 MSV0UL  M20AM  M273P   1</span></span></code></pre></div>
<p>The output of the <code><a href="../reference/get_colony.html">get_colony()</a></code> and
<code><a href="../reference/get_ped.html">get_ped()</a></code> functions can can be formatted in different ways
to facilitate downstream analysis with other R packages for pedigree
analysis and visualization. The format of the output is defined by
<code>out</code> parameter. Both functions support downstream analysis
with <a href="https://cran.r-project.org/package=kinship2" class="external-link"><code>kinship2</code></a>,
<a href="https://cran.r-project.org/package=pedtools" class="external-link"><code>pedtools</code></a>
or <a href="https://bioconductor.org/packages/FamAgg/" class="external-link"><code>FamAgg</code></a>
packages.</p>
<div class="section level4">
<h4 id="example-get_colony-kinship2">[example] get_colony() &amp; kinship2<a class="anchor" aria-label="anchor" href="#example-get_colony-kinship2"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=kinship2" class="external-link">kinship2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loading required package: quadprog</span></span>
<span><span class="va">ped_ks2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_colony.html">get_colony</a></span><span class="op">(</span><span class="va">path</span>, <span class="va">wolf_samples</span>, out <span class="op">=</span> <span class="st">"kinship2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ped_ks2</span> <span class="op">&lt;-</span> <span class="va">ped_ks2</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">ped_ks2</span><span class="op">$</span><span class="va">dadid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"M2AM8"</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">ped_ks2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/kinship2/man/pedigree.html" class="external-link">pedigree</a></span><span class="op">(</span></span>
<span>  <span class="va">ped_ks2</span><span class="op">$</span><span class="va">id</span>,</span>
<span>  <span class="va">ped_ks2</span><span class="op">$</span><span class="va">dadid</span>,</span>
<span>  <span class="va">ped_ks2</span><span class="op">$</span><span class="va">momid</span>,</span>
<span>  <span class="va">ped_ks2</span><span class="op">$</span><span class="va">sex</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ped_ks2</span>, symbolsize <span class="op">=</span> <span class="fl">1.5</span>, cex <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<p><img src="wpeR_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; Did not plot the following people: M2AM8</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="animal-timespan">Animal timespan<a class="anchor" aria-label="anchor" href="#animal-timespan"></a>
</h3>
<p><code><a href="../reference/anim_timespan.html">anim_timespan()</a></code> function creates ‘first seen’ and ‘last
seen’ columns for each animal in the pedigree by examining the dates of
all genetic samples associated with that animal. This is an important
step in obtaining a temporal perspective of the pedigree, as it allows
other functions to work with time frame over which each animal was
observed. Besides that the functions determines if animal is dead based
on predefined sample type eg. tissue.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animal_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anim_timespan.html">anim_timespan</a></span><span class="op">(</span></span>
<span>  individual_id <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">AnimalRef</span>,</span>
<span>  sample_date <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">Date</span>,</span>
<span>  sample_type <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">SType</span>,</span>
<span>  dead <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tissue"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">animal_ts</span><span class="op">)</span></span>
<span><span class="co">#&gt;      ID  FirstSeen   LastSeen IsDead</span></span>
<span><span class="co">#&gt; 1 M10XC 2017-11-16 2017-12-22  FALSE</span></span>
<span><span class="co">#&gt; 2 M1J47 2019-08-20 2021-01-07  FALSE</span></span>
<span><span class="co">#&gt; 3 M1YP0 2017-01-25 2017-01-25   TRUE</span></span>
<span><span class="co">#&gt; 4 M200F 2015-07-27 2018-08-22  FALSE</span></span>
<span><span class="co">#&gt; 5 M20AM 2016-08-29 2020-08-02  FALSE</span></span>
<span><span class="co">#&gt; 6 M220J 2017-11-10 2018-02-17  FALSE</span></span></code></pre></div>
<p>As shown above the <code><a href="../reference/anim_timespan.html">anim_timespan()</a></code> function creates a
sort of a code list of animal detection time frame. To feed this data to
subsequent functions the <code><a href="../reference/anim_timespan.html">anim_timespan()</a></code> function output
needs to be merged with sample metadata. This additional step ensures
that all relevant information about each animal is included and
facilitates downstream analysis.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampledata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">wolf_samples</span>, <span class="va">animal_ts</span>, by.x <span class="op">=</span> <span class="st">"AnimalRef"</span>, by.y <span class="op">=</span> <span class="st">"ID"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sampledata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   AnimalRef Sample       Date GeneticSex      lat      lng SType  FirstSeen</span></span>
<span><span class="co">#&gt; 1     M10XC  M10XC 2017-11-16          M 45.70766 14.12922  Scat 2017-11-16</span></span>
<span><span class="co">#&gt; 2     M10XC  M0PXH 2017-11-22          M 45.71356 14.10497  Scat 2017-11-16</span></span>
<span><span class="co">#&gt; 3     M10XC  M0PFL 2017-12-22          M 45.69898 14.07907  Scat 2017-11-16</span></span>
<span><span class="co">#&gt; 4     M1J47  M1J47 2019-08-20          M 45.70854 14.09644  Scat 2019-08-20</span></span>
<span><span class="co">#&gt; 5     M1J47  M1HF2 2019-08-31          M 45.69930 14.05550  Scat 2019-08-20</span></span>
<span><span class="co">#&gt; 6     M1J47 MSV163 2020-07-17          M 45.71804 14.14319  Scat 2019-08-20</span></span>
<span><span class="co">#&gt;     LastSeen IsDead</span></span>
<span><span class="co">#&gt; 1 2017-12-22  FALSE</span></span>
<span><span class="co">#&gt; 2 2017-12-22  FALSE</span></span>
<span><span class="co">#&gt; 3 2017-12-22  FALSE</span></span>
<span><span class="co">#&gt; 4 2021-01-07  FALSE</span></span>
<span><span class="co">#&gt; 5 2021-01-07  FALSE</span></span>
<span><span class="co">#&gt; 6 2021-01-07  FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="organize-families">Organize families<a class="anchor" aria-label="anchor" href="#organize-families"></a>
</h3>
<p>The <code><a href="../reference/org_fams.html">org_fams()</a></code> function takes the pedigree data
generated by the <code><a href="../reference/get_colony.html">get_colony()</a></code>/<code><a href="../reference/get_ped.html">get_ped()</a></code>
function and groups animals into families. This function expands the
pedigree by adding information about the family that each individual was
born in and the individual’s status as a reproductive animal. Based on
the ´output´ parameter the function can return a data frame (ped or
fams) or a list with two objects (ped and fams). In the examples below
we will present each of the two data frames separately.</p>
<p>The result of <code><a href="../reference/org_fams.html">org_fams()</a></code> function introduces us to two
important concepts within the context of this package: <em>family</em>
and <em>half-sib group</em>. In the <strong>wpeR</strong> package, a
<em>family</em> is defined as a group of animals where at least one
parent and at least one offspring are known. Meanwhile, a <em>half-sib
group</em> refers to a group of half-siblings who are either maternally
or paternally related. In the function’s output, the
<code>DadHSgroup</code> parameter groups paternal half-siblings, while
the <code>MomHSgroup</code> parameter groups maternal half-siblings.</p>
<div class="section level4">
<h4 id="pedigree">Pedigree<a class="anchor" aria-label="anchor" href="#pedigree"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ped_org</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/org_fams.html">org_fams</a></span><span class="op">(</span>ped <span class="op">=</span> <span class="va">ped_colony</span>, sampledata <span class="op">=</span> <span class="va">sampledata</span>, output <span class="op">=</span> <span class="st">"ped"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">ped_org</span><span class="op">)</span></span>
<span><span class="co">#&gt;    ClusterIndex     id father mother sex     parents FamID  FirstSeen</span></span>
<span><span class="co">#&gt; 60            1 MSV0T7  M20AM  M273P   1 M20AM_M273P     5 2019-08-11</span></span>
<span><span class="co">#&gt; 61            1 MSV0TJ  M20AM  M273P   2 M20AM_M273P     5 2019-12-28</span></span>
<span><span class="co">#&gt; 62            1 MSV0UL  M20AM  M273P   1 M20AM_M273P     5 2020-07-15</span></span>
<span><span class="co">#&gt; 63            1 MSV0X4  M20AM  M273P   1 M20AM_M273P     5 2019-09-03</span></span>
<span><span class="co">#&gt; 64            1 MSV17F  M20AM  M273P   2 M20AM_M273P     5 2020-11-08</span></span>
<span><span class="co">#&gt; 65            1 MSV1MH  M20AM  M273P   2 M20AM_M273P     5 2021-02-25</span></span>
<span><span class="co">#&gt;      LastSeen IsDead DadHSgroup MomHSgroup hsGroup</span></span>
<span><span class="co">#&gt; 60 2020-02-09   TRUE       &lt;NA&gt;       &lt;NA&gt;       4</span></span>
<span><span class="co">#&gt; 61 2019-12-28   TRUE       &lt;NA&gt;       &lt;NA&gt;       4</span></span>
<span><span class="co">#&gt; 62 2020-07-15  FALSE       &lt;NA&gt;       &lt;NA&gt;       4</span></span>
<span><span class="co">#&gt; 63 2019-10-23   TRUE       &lt;NA&gt;       &lt;NA&gt;       4</span></span>
<span><span class="co">#&gt; 64 2020-12-04  FALSE       &lt;NA&gt;       &lt;NA&gt;       4</span></span>
<span><span class="co">#&gt; 65 2021-07-15  FALSE       &lt;NA&gt;       &lt;NA&gt;       4</span></span></code></pre></div>
<p>The <code>ped</code> output is just an extend version of pedigree
obtained by <code><a href="../reference/get_colony.html">get_colony()</a></code> function. Apart from common
pedigree information individual, mother, father, sex, family),
<code>ped</code> also includes information on:</p>
<ul>
<li>
<code>parents</code>: identifier codes of both parents separated
with ⁠_⁠,</li>
<li>
<code>FamID</code>: number of family that the individual belongs to
(see Families below),</li>
<li>
<code>FirstSeen</code>: date of first sample of individual,</li>
<li>
<code>LastSeen</code>: date of last sample of individual,</li>
<li>
<code>IsDead</code>: logical value (TRUE/FALSE) that identifies if
the individual is dead,</li>
<li>
<code>DadHSgroup</code>: identifier of paternal half-sib group,</li>
<li>
<code>MomHSgroup</code>: identifier of maternal half-sib group,</li>
<li>
<code>hsGroup</code>: half-sib group of the individual.</li>
</ul>
</div>
<div class="section level4">
<h4 id="families">Families<a class="anchor" aria-label="anchor" href="#families"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fams_org</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/org_fams.html">org_fams</a></span><span class="op">(</span>ped <span class="op">=</span> <span class="va">ped_colony</span>, sampledata <span class="op">=</span> <span class="va">sampledata</span>, output <span class="op">=</span> <span class="st">"fams"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fams_org</span><span class="op">)</span></span>
<span><span class="co">#&gt;         parents   father   mother FamID   FamStart     FamEnd FamDead</span></span>
<span><span class="co">#&gt; 7   M228J_M200F    M228J    M200F     1 2017-01-25 2018-08-22    TRUE</span></span>
<span><span class="co">#&gt; 15 MSV00E_M28LU   MSV00E    M28LU     2 2020-08-16 2021-03-05   FALSE</span></span>
<span><span class="co">#&gt; 24  M2772_M28TU    M2772    M28TU     3 2019-08-28 2021-04-23   FALSE</span></span>
<span><span class="co">#&gt; 33  M2AM8_M200F    M2AM8    M200F     4 2018-10-29 2021-03-23   FALSE</span></span>
<span><span class="co">#&gt; 51  M20AM_M273P    M20AM    M273P     5 2018-01-05 2020-08-02   FALSE</span></span>
<span><span class="co">#&gt; NA      Unknown *Unknown #Unknown     0 2015-07-27 2021-04-23   FALSE</span></span>
<span><span class="co">#&gt;    DadHSgroup MomHSgroup hsGroup</span></span>
<span><span class="co">#&gt; 7        &lt;NA&gt;     MomP_1       1</span></span>
<span><span class="co">#&gt; 15       &lt;NA&gt;       &lt;NA&gt;       2</span></span>
<span><span class="co">#&gt; 24       &lt;NA&gt;       &lt;NA&gt;       3</span></span>
<span><span class="co">#&gt; 33       &lt;NA&gt;     MomP_1       1</span></span>
<span><span class="co">#&gt; 51       &lt;NA&gt;       &lt;NA&gt;       4</span></span>
<span><span class="co">#&gt; NA       &lt;NA&gt;       &lt;NA&gt;       0</span></span></code></pre></div>
<p>The <code>fams</code> output contains information about the families
to which individuals in the pedigree belong. The families are described
by:</p>
<ul>
<li>
<code>parents</code>: identifier codes of both parents separated
with ⁠_⁠,</li>
<li>
<code>father</code>: identifier code of the father,</li>
<li>
<code>mother</code>: identifier code of the mother,</li>
<li>
<code>FamID</code>: numeric value that identifies a particular
family,</li>
<li>
<code>famStart</code>: date when the first sample of any of the
family members was collected<sup>1</sup>,</li>
<li>
<code>famEnd</code>: date when the last sample of any of the family
members was collected<sup>1</sup>,</li>
<li>
<code>FamDead</code>: logical value (TRUE/FALSE) that identifies if
the family does not exist any more,</li>
<li>
<code>DadHSgroup</code>: Identifier connecting families that share
the same father.</li>
<li>
<code>MomHSgroup</code>: Identifier connecting families that share
the same mother.</li>
<li>
<code>hsGroup</code>: Numeric value connecting families that share
one of the parents.</li>
</ul>
<p><sup>1</sup><small><code>famStart</code> and <code>famEnd</code>
columns, estimate a time window for the family based solely on sample
collection dates provided in <code>sampledata</code>.
<code>famStart</code> indicates the date of the earliest sample
collected from any offspring belonging to that family.
<code>famEnd</code> indicates the date of the latest sample collected
from either the mother or the father of that family. It is important to
recognize that this method relies on observation (sampling) dates.
Consequently, <code>famEnd</code> (last parental sample date) can
precede <code>famStart</code> (first offspring sample date), creating a
biologically impossible sequence and a negative calculated family
timespan. Users should interpret the interval between
<code>famStart</code> and <code>famEnd</code> with this
understanding.</small></p>
</div>
</div>
<div class="section level3">
<h3 id="plotting-table">Plotting table<a class="anchor" aria-label="anchor" href="#plotting-table"></a>
</h3>
<p>To produce a temporal and spatial pedigree representation, the sample
metadata needs to be formatted in a specific way, which can be achieved
with the <code><a href="../reference/plot_table.html">plot_table()</a></code> function. This function combines the
outputs of previous functions (<code>fams</code> and <code>ped</code>
from the <code><a href="../reference/org_fams.html">org_fams()</a></code> function) with sample metadata, with
all three data frames serving as inputs.</p>
<p>The function offers flexibility in selecting families for
visualization through the <code>plot_fams</code> parameter. To include
all families included in the pedigree, <code>plot_fams</code> should be
set to “all” (which is the default). For plotting a subset of families,
provide a numeric vector of the desired FamIDs, which are the family
identification numbers generated by <code><a href="../reference/org_fams.html">org_fams()</a></code> and can be
seen in the <code>fams</code> output table.</p>
<p>In order for the <code><a href="../reference/plot_table.html">plot_table()</a></code> function to work sample
metadata has to include some specific information, most of them are
already defined in the Input data part of this vignette, apart form them
the sample metadata must also include columns on the date of first and
last sample of individual and logical value identifying if the
individual is dead. All this additional information can be added by
<code><a href="../reference/anim_timespan.html">anim_timespan()</a></code> function (see Animal timespan). If the
information stored in sample data does not use default column names (to
see them check documentation <code><a href="../reference/plot_table.html">?plot_table</a></code>) the custom names
can be defined as a vector with parameter <em>datacolumns</em>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_table.html">plot_table</a></span><span class="op">(</span></span>
<span>  plot_fams <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  all_fams <span class="op">=</span> <span class="va">fams_org</span>,</span>
<span>  ped <span class="op">=</span> <span class="va">ped_org</span>,</span>
<span>  sampledata <span class="op">=</span> <span class="va">sampledata</span>,</span>
<span>  deadSample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tissue"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pt</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Sample AnimalRef GeneticSex       Date  SType      lat      lng  FirstSeen</span></span>
<span><span class="co">#&gt; 54   M20AP     M228J          M 2016-09-30 Saliva 45.71140 14.01201 2016-09-30</span></span>
<span><span class="co">#&gt; 55   M228J     M228J          M 2017-01-26   Scat 45.70406 14.12798 2016-09-30</span></span>
<span><span class="co">#&gt; 56   M28ML     M228J          M 2017-08-18 Saliva 45.67397 14.11150 2016-09-30</span></span>
<span><span class="co">#&gt; 57   M28MM     M228J          M 2017-08-18 Saliva 45.67397 14.11150 2016-09-30</span></span>
<span><span class="co">#&gt; 58   M2C36     M228J          M 2018-02-09 Tissue 45.67033 14.15404 2016-09-30</span></span>
<span><span class="co">#&gt; 10 EX.1JH0     M200F          F 2015-07-27 Saliva 45.75250 14.14653 2015-07-27</span></span>
<span><span class="co">#&gt;      LastSeen IsDead plottingID FamID hsGroup  rep later_rep isPolygamous  dead</span></span>
<span><span class="co">#&gt; 54 2018-02-09   TRUE          1     1       1 TRUE     FALSE        FALSE FALSE</span></span>
<span><span class="co">#&gt; 55 2018-02-09   TRUE          1     1       1 TRUE     FALSE        FALSE FALSE</span></span>
<span><span class="co">#&gt; 56 2018-02-09   TRUE          1     1       1 TRUE     FALSE        FALSE FALSE</span></span>
<span><span class="co">#&gt; 57 2018-02-09   TRUE          1     1       1 TRUE     FALSE        FALSE FALSE</span></span>
<span><span class="co">#&gt; 58 2018-02-09   TRUE          1     1       1 TRUE     FALSE        FALSE  TRUE</span></span>
<span><span class="co">#&gt; 10 2018-08-22  FALSE          2     1       1 TRUE     FALSE         TRUE FALSE</span></span>
<span><span class="co">#&gt;    first_sample last_sample IsReference</span></span>
<span><span class="co">#&gt; 54         TRUE       FALSE       FALSE</span></span>
<span><span class="co">#&gt; 55        FALSE       FALSE        TRUE</span></span>
<span><span class="co">#&gt; 56        FALSE       FALSE       FALSE</span></span>
<span><span class="co">#&gt; 57        FALSE       FALSE       FALSE</span></span>
<span><span class="co">#&gt; 58        FALSE        TRUE       FALSE</span></span>
<span><span class="co">#&gt; 10         TRUE       FALSE       FALSE</span></span></code></pre></div>
<p>The <code><a href="../reference/plot_table.html">plot_table()</a></code> function output adds additional
information to sample metadata which include:</p>
<ul>
<li>
<code>plottingID</code>: Identifier number for temporal pedigree
plot <code>ped_satplot</code>. In case of polygamous animals same
individual can be included in more than one family,</li>
<li>
<code>FamID</code>: Identifier number of family that individual
belongs to,</li>
<li>
<code>hsGroup</code>: Numeric. Identifier number for the half-sib
group of individual.</li>
<li>
<code>rep</code>: Is individual reproductive in current family,
(current family defined with FamID for a particular entry),</li>
<li>
<code>later_rep</code>: Is individual reproductive in any other
(later) families,</li>
<li>
<code>isPolygamous</code>: Has individual more than one mate,</li>
<li>
<code>dead</code>: Is individual dead,</li>
<li>
<code>first_sample</code>: Is this particular sample the first
sample of individual,</li>
<li>
<code>last_sample</code>: Is this particular sample the last sample
of individual,</li>
<li>
<code>isReference</code>: Is this particular sample reference sample
of individual.</li>
</ul>
<p>Apart from adding additional information to sample metadata,
<code><a href="../reference/plot_table.html">plot_table()</a></code> also duplicates sample entries (rows) for
animals that are present in more than one family (eg. polygamous
animals, animals that were detected as offspring in one family and later
as reproductive animal in another). Considering that, it is crucial for
users to be aware of this data duplication when utilizing the
<code><a href="../reference/plot_table.html">plot_table()</a></code> output in analysis outside of the scope of
this package.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampledata</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pt</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>After applying the <code><a href="../reference/plot_table.html">plot_table()</a></code> function, the pedigree
data is prepared for temporal and spatial visualization, marking the
completion of the data preparation phase in this package’s workflow. The
data visualization stage involves two functions:
<code><a href="../reference/ped_satplot.html">ped_satplot()</a></code> for temporal representation and
<code><a href="../reference/ped_spatial.html">ped_spatial()</a></code> for spatial representation.</p>
</div>
<div class="section level3">
<h3 id="temporal-plot">Temporal plot<a class="anchor" aria-label="anchor" href="#temporal-plot"></a>
</h3>
<p>The core of the temporal plot, generated by the
<code><a href="../reference/ped_satplot.html">ped_satplot()</a></code> function, is the representation of the
occurrence of samples for each individual (y-axis) trough time (x-axis).
Furthermore the individuals are first grouped by families and then by
half-sib groups. Within each family, the individuals are arranged from
top to bottom based on the date of their first sample collection. At the
bottom of each family, the animal that was initially detected is
positioned, followed by subsequent animals in chronological order. This
layout enables a visual understanding of the temporal relationships
within and between families, with each family forming a distinct cluster
in the plot.</p>
<p>Each sample is visually depicted as a point on the plot, and these
points are connected by lines to represent the continuous survival of
the individual. This connection remains intact even during periods where
no samples of that particular individual were collected. Each sample can
be additional marked to represent any additional characteristics of a
particular individual (eg. reproductive animal, polygamous animal).
Additionally, certain samples can be marked to indicate mortality (eg.
tissue samples).</p>
<p><img src="wpeR_files/figure-html/ped_satplot%20legend-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Before we get started with the first plot it is important to look
back at <code><a href="../reference/plot_table.html">plot_table()</a></code> function and the previously mentioned
<em>plot_fams</em> parameter. This parameter allow us to select a subset
of families that we would like to plot. In the below example just one
family (FamID = 4) is selected for plotting.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_table.html">plot_table</a></span><span class="op">(</span></span>
<span>  plot_fams <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  all_fams <span class="op">=</span> <span class="va">fams_org</span>,</span>
<span>  ped <span class="op">=</span> <span class="va">ped_org</span>,</span>
<span>  sampledata <span class="op">=</span> <span class="va">sampledata</span>,</span>
<span>  deadSample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tissue"</span>, <span class="st">"Decomposing Tissue"</span>, <span class="st">"Blood"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped_satplot.html">ped_satplot</a></span><span class="op">(</span><span class="va">pt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp</span> </span></code></pre></div>
<p><img src="wpeR_files/figure-html/unnamed-chunk-15-1.png" width="624" style="display: block; margin: auto;"></p>
<p>An example of two families that share the same mother (FamID = 1
&amp; 4)</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_table.html">plot_table</a></span><span class="op">(</span></span>
<span>  plot_fams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>  all_fams <span class="op">=</span> <span class="va">fams_org</span>,</span>
<span>  ped <span class="op">=</span> <span class="va">ped_org</span>,</span>
<span>  sampledata <span class="op">=</span> <span class="va">sampledata</span>,</span>
<span>  deadSample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tissue"</span>, <span class="st">"Decomposing Tissue"</span>, <span class="st">"Blood"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped_satplot.html">ped_satplot</a></span><span class="op">(</span><span class="va">pt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp</span></span></code></pre></div>
<p><img src="wpeR_files/figure-html/unnamed-chunk-16-1.png" width="624" style="display: block; margin: auto;"></p>
<p>Technically, there is no limit to the number of families that can be
plotted in this manner. However, as the number of families increases,
the complexity of the graph intensifies, making it progressively more
challenging to comprehend. This can be observed in the example of five
families, two of which share a reproductive animal.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_table.html">plot_table</a></span><span class="op">(</span></span>
<span>  plot_fams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>  all_fams <span class="op">=</span> <span class="va">fams_org</span>,</span>
<span>  ped <span class="op">=</span> <span class="va">ped_org</span>,</span>
<span>  sampledata <span class="op">=</span> <span class="va">sampledata</span>,</span>
<span>  deadSample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tissue"</span>, <span class="st">"Decomposing Tissue"</span>, <span class="st">"Blood"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped_satplot.html">ped_satplot</a></span><span class="op">(</span><span class="va">pt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sp</span></span></code></pre></div>
<p><img src="wpeR_files/figure-html/unnamed-chunk-17-1.png" width="624" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="spatial-files">Spatial files<a class="anchor" aria-label="anchor" href="#spatial-files"></a>
</h3>
<p>To incorporate a spatial dimension into the pedigree analysis, the
<code><a href="../reference/ped_spatial.html">ped_spatial()</a></code> function comes into play. Acting as a wrapper
function, <code><a href="../reference/ped_spatial.html">ped_spatial()</a></code> combines multiple functions that
utilize the output of the <code><a href="../reference/plot_table.html">plot_table()</a></code> function,
transforming it into various <a href="https://r-spatial.github.io/sf/articles/sf1.html" class="external-link">sf</a> objects
that can be visualized on a map. It’s worth noting that the function
automatically removes samples without coordinates, as they cannot be
plotted.</p>
<p>By utilizing the default function parameters, the ped_spatial()
function produces a list containing 14 <code>sf</code> objects.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_table.html">plot_table</a></span><span class="op">(</span></span>
<span>  plot_fams <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  all_fams <span class="op">=</span> <span class="va">fams_org</span>,</span>
<span>  ped <span class="op">=</span> <span class="va">ped_org</span>,</span>
<span>  sampledata <span class="op">=</span> <span class="va">sampledata</span>,</span>
<span>  deadSample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tissue"</span>, <span class="st">"Decomposing Tissue"</span>, <span class="st">"Blood"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped_spatial.html">ped_spatial</a></span><span class="op">(</span><span class="va">pt</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       Length Class Mode</span></span>
<span><span class="co">#&gt; motherRpoints         16     sf    list</span></span>
<span><span class="co">#&gt; fatherRpoints         16     sf    list</span></span>
<span><span class="co">#&gt; offspringRpoints      19     sf    list</span></span>
<span><span class="co">#&gt; motherMovePoints      16     sf    list</span></span>
<span><span class="co">#&gt; fatherMovePoints      16     sf    list</span></span>
<span><span class="co">#&gt; offspringMovePoints   19     sf    list</span></span>
<span><span class="co">#&gt; maternityLines         8     sf    list</span></span>
<span><span class="co">#&gt; paternityLines         8     sf    list</span></span>
<span><span class="co">#&gt; motherMoveLines        3     sf    list</span></span>
<span><span class="co">#&gt; fatherMoveLines        3     sf    list</span></span>
<span><span class="co">#&gt; offspringMoveLines     3     sf    list</span></span>
<span><span class="co">#&gt; motherMovePolygons     3     sf    list</span></span>
<span><span class="co">#&gt; fatherMovePolygons     3     sf    list</span></span>
<span><span class="co">#&gt; offspringMovePolygons  3     sf    list</span></span></code></pre></div>
<p>Through the integration of <code>POINT</code>,
<code>LINESTRING</code>, and <code>POLYGON</code> geometries, the
<code><a href="../reference/ped_spatial.html">ped_spatial()</a></code> function generates <code>sf</code> objects
that establish connections between parent and offspring samples, as well
as samples of the same individual. This enables users to analyze and
interpret the spatial progression of a pedigree. Created objects can be
categorized into 5 broader categories:</p>
<ul>
<li>
<code>...Rpoints</code>: POINT object representing reference sample
of each animal. In the case of <code>...Rpoints</code> the number of
points represents the number of animals included in
<code><a href="../reference/plot_table.html">plot_table()</a></code> function output. The reference points
represent just one sample of each individual. For reproductive
individuals (mothers and fathers), a reference point is the location of
their last sample within the specified time window. For offspring, the
reference point is the location of their first sample within the time
window.</li>
<li>
<code>...MovePoints</code>: POINT object representing all samples of
a particular animal.</li>
<li>
<code>maternity/paternityLines</code>: LINESTRING object connecting
reference samples of mothers (<code>motherRpoints</code>) or fathers
(<code>fatherRpoints</code>) with reference samples of their offspring
(<code>offspringRpoints</code>). These lines visually depict the
parent-offspring relationships in the pedigree.</li>
<li>
<code>...MoveLines</code>: LINESTRING object connecting
<code>...MovePoints</code> of an individual in chronological order,
showcasing the movement or changes in location over time for the
specific animal.</li>
<li>
<code>...MovePolygons</code>: POLYGON object representing a convex
hull that encloses all the samples of an individual. It provides a
graphical representation of the spatial extent or range covered by the
animal based on its sample locations.</li>
</ul>
<p>By specifying the <em>fulsibdata</em> parameter in the
<code><a href="../reference/ped_spatial.html">ped_spatial()</a></code> function, you can include the
<code>FullsibLines</code> object in the output list. The
<code>FullsibLines</code> is a LINESTRING object connecting reference
samples of full siblings.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fullsibdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">path</span>,<span class="st">".FullSibDyad"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped_spatial.html">ped_spatial</a></span><span class="op">(</span><span class="va">pt</span>, fullsibdata <span class="op">=</span> <span class="va">fullsibdata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span></span>
<span><span class="co">#&gt;                       Length Class Mode</span></span>
<span><span class="co">#&gt; motherRpoints         16     sf    list</span></span>
<span><span class="co">#&gt; fatherRpoints         16     sf    list</span></span>
<span><span class="co">#&gt; offspringRpoints      19     sf    list</span></span>
<span><span class="co">#&gt; motherMovePoints      16     sf    list</span></span>
<span><span class="co">#&gt; fatherMovePoints      16     sf    list</span></span>
<span><span class="co">#&gt; offspringMovePoints   19     sf    list</span></span>
<span><span class="co">#&gt; maternityLines         8     sf    list</span></span>
<span><span class="co">#&gt; paternityLines         8     sf    list</span></span>
<span><span class="co">#&gt; motherMoveLines        3     sf    list</span></span>
<span><span class="co">#&gt; fatherMoveLines        3     sf    list</span></span>
<span><span class="co">#&gt; offspringMoveLines     3     sf    list</span></span>
<span><span class="co">#&gt; motherMovePolygons     3     sf    list</span></span>
<span><span class="co">#&gt; fatherMovePolygons     3     sf    list</span></span>
<span><span class="co">#&gt; offspringMovePolygons  3     sf    list</span></span>
<span><span class="co">#&gt; FullsibLines           4     sf    list</span></span></code></pre></div>
<p>In the <code><a href="../reference/ped_spatial.html">ped_spatial()</a></code> function, you have the flexibility
to define the time window for selecting the samples used to generate the
spatial pedigree outputs. By specifying the <em>time.limits</em>
parameter, you can set the start and end dates that limit the samples
included in the spatial representation. The <em>time.limits</em>
parameter is defined as a vector of two dates in <code>Date</code>
format. Moreover, the function provides the option to apply
<em>time.limits</em> selectively to specific types of output data: -
<code>time.limit.rep</code>parameter enables the application of time
limits solely to offspring reference and movement points, -
<code>time.limit.offspring</code> parameter applies the time.limits to
offspring reference and movement points, - <code>time.limit.moves</code>
parameter permits the application of time limits to the movement lines
of all individuals.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_tl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped_spatial.html">ped_spatial</a></span><span class="op">(</span></span>
<span>  plottable <span class="op">=</span> <span class="va">pt</span>,</span>
<span>  time.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2017-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2018-01-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time.limit.rep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  time.limit.offspring <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  time.limit.moves <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="example-drawing-maps-in-r">[example] Drawing maps in R<a class="anchor" aria-label="anchor" href="#example-drawing-maps-in-r"></a>
</h4>
<p>To showcase the capabilities of the <code><a href="../reference/ped_spatial.html">ped_spatial()</a></code>
function and to deepen our comprehension of the data frames generated by
this function, we present a series of examples that highlight maps
produced through the utilization of the wpeR package. These examples
make use of various R packages enable visual representation of
geographic datasets.</p>
<div class="section level5">
<h5 id="ggplot2">ggplot2<a class="anchor" aria-label="anchor" href="#ggplot2"></a>
</h5>
<p>In the similar fashion as the temporal plots in chapter 2.5, the
first set of maps shows just one family. The maps are static and
produced with <a href="https://CRAN.R-project.org/package=ggplot2" class="external-link"><code>ggplot2</code></a>,
<a href="https://CRAN.R-project.org/package=basemaps" class="external-link"><code>basemaps</code></a>
and <a href="https://github.com/yutannihilation/ggsflabel" class="external-link"><code>ggsflabel</code></a>
packages. To clearly represent the output of <code><a href="../reference/ped_spatial.html">ped_spatial()</a></code>
function different spatial files are presented separately on three maps.
First showing the pedigree, second movement of reproductive animals and
the third movement of the offspring. Furthermore, each of the three maps
is represented in two different variants, one showing all the samples of
the family members included in the sample metadata table and the other
utilizing the <em>time.limits</em> parameter, subletting the samples to
within a defined time window (presented on temporal plot with orange
dotted rectangle).</p>
<p>We begin by creating a plotting table (plot.table) of the
family/families we would like to plot (in this example family with FamID
== 1), through the <code><a href="../reference/plot_table.html">plot_table()</a></code> function. Subsequently, the
<code><a href="../reference/ped_spatial.html">ped_spatial()</a></code> function is applied to generate a list of
<code>sf</code> data frames representing the distribution of animal
samples and their relationships. Additionally we generate a second list
of <code>sf</code> files in which all the generated dataframes are
limited to the period between “2017-01-01” and “2018-01-01”.</p>
<p>It is worth noting that depending on the number of families,
individuals and samples the maps generated from these data can appear
complex and cluttered, especially if the time.limits parameter is not
employed. This parameter is crucial in refining the visualizations,
enhancing their clarity and interpretability.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_table.html">plot_table</a></span><span class="op">(</span></span>
<span>  plot_fams <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  all_fams <span class="op">=</span> <span class="va">fams_org</span>,</span>
<span>  ped <span class="op">=</span> <span class="va">ped_org</span>,</span>
<span>  sampledata <span class="op">=</span> <span class="va">sampledata</span>,</span>
<span>  deadSample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tissue"</span>, <span class="st">"Decomposing Tissue"</span>, <span class="st">"Blood"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped_spatial.html">ped_spatial</a></span><span class="op">(</span><span class="va">pt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps.tl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped_spatial.html">ped_spatial</a></span><span class="op">(</span></span>
<span>  plottable <span class="op">=</span> <span class="va">pt</span>,</span>
<span>  time.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2017-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2018-01-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time.limit.rep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  time.limit.offspring <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  time.limit.moves <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="wpeR_files/figure-html/unnamed-chunk-22-1.png" alt="Temporal plot, showing all individuals and samples of the plotted family.
 Orange dashed rectangle encopasses samples that fall within defined time limits." width="624"><p class="caption">
Temporal plot, showing all individuals and samples of the plotted
family. Orange dashed rectangle encopasses samples that fall within
defined time limits.
</p>
</div>
<br><div class="figure" style="text-align: center">
<img src="wpeR_files/figure-html/ggplot%20legend-1.png" alt="Legend explaining symbols used for spatial pedigree representation." width="700"><p class="caption">
Legend explaining symbols used for spatial pedigree representation.
</p>
</div>
<br><div class="figure" style="text-align: center">
<img src="wpeR_files/figure-html/unnamed-chunk-23-1.png" alt="Spatial pedigree representation. a) all samples, b) time window." width="100%"><p class="caption">
Spatial pedigree representation. a) all samples, b) time window.
</p>
</div>
<br><div class="figure" style="text-align: center">
<img src="wpeR_files/figure-html/unnamed-chunk-24-1.png" alt="Movement of reproductive animals as inffered from collected samples. a) all samples, b) time window." width="100%"><p class="caption">
Movement of reproductive animals as inffered from collected samples. a)
all samples, b) time window.
</p>
</div>
<br><div class="figure" style="text-align: center">
<img src="wpeR_files/figure-html/unnamed-chunk-25-1.png" alt="Movement of offspring as inffered from collected samples. a) all samples, b) time window." width="100%"><p class="caption">
Movement of offspring as inffered from collected samples. a) all
samples, b) time window.
</p>
</div>
<p><br></p>
</div>
<div class="section level5">
<h5 id="leaflet">leaflet<a class="anchor" aria-label="anchor" href="#leaflet"></a>
</h5>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet.providers/" class="external-link">leaflet.providers</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_table.html">plot_table</a></span><span class="op">(</span>plot_fams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>                        <span class="va">fams_org</span>,</span>
<span>                        <span class="va">ped_org</span>,</span>
<span>                        <span class="va">sampledata</span>,</span>
<span>                        deadSample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tissue"</span>, <span class="st">"Decomposing Tissue"</span>, <span class="st">"Blood"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ped_spatial.html">ped_spatial</a></span><span class="op">(</span><span class="va">pt</span>,</span>
<span>                  time.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-07-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-06-30"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            time.limit.rep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            time.limit.offspring <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            time.limit.moves <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:1050px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB.PositronNoLabels",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircleMarkers","args":[[45.60573,46.28649,45.593778082641,45.6330119540741],[14.49858,14.05114,14.1965906256871,14.3731614196494],5,null,"Father Reference",{"interactive":true,"className":"","stroke":true,"color":"#1f78b4","weight":5,"opacity":0.5,"fill":true,"fillColor":"#1f78b4","fillOpacity":0.2},null,null,["Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>"],null,["M20AM","M2772","M2AM8","MSV00E"],{"interactive":false,"permanent":true,"direction":"auto","opacity":1,"offset":[12,12,12,12],"textsize":"10px","textOnly":true,"style":{"color":"#1f78b4"},"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[45.60573,45.60573,45.60573,46.28649,45.70894581,45.7190875187433,45.7123749129673,45.7025958430667,45.593778082641,45.7325,45.7347,45.6688584283559,45.6119282093501,45.6089963126655,45.6961329625972,45.7023899126724,45.7032709493347,45.6975587325296,45.6869260613992,45.6957767180808,45.6869260613992,45.6330119540741],[14.49858,14.49858,14.49858,14.05114,14.08487618,14.1147190955103,14.1323574857189,14.1482015808661,14.1965906256871,14.2859,14.2819,14.3470930449133,14.3419067953084,14.3548386845148,14.3981373650013,14.3826631157154,14.3791860255052,14.39804827173,14.3597211851049,14.3339395093881,14.3597211851049,14.3731614196494],2,null,"Father Movemet",{"interactive":true,"className":"","stroke":true,"color":"#1f78b4","weight":5,"opacity":0.5,"fill":true,"fillColor":"#1f78b4","fillOpacity":0.2},null,null,["Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>"],null,["M20AM","M20AM","M20AM","M2772","M2AM8","M2AM8","M2AM8","M2AM8","M2AM8","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E"],{"interactive":false,"permanent":true,"direction":"auto","opacity":1,"offset":[12,12,12,12],"textsize":"10px","textOnly":true,"style":{"color":"black"},"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[45.66033887,45.7050621120799,46.269109],[14.43701769,14.3851990899332,14.010106],5,null,"Mother Reference",{"interactive":true,"className":"","stroke":true,"color":"#b7484b","weight":5,"opacity":0.5,"fill":true,"fillColor":"#b7484b","fillOpacity":0.2},null,null,["Sex: F <br>","Sex: F <br>","Sex: F <br>"],null,["M273P","M28LU","M28TU"],{"interactive":false,"permanent":true,"direction":"auto","opacity":1,"offset":[12,12,12,12],"textsize":"10px","textOnly":true,"style":{"color":"#b7484b"},"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[45.66033887,45.66033887,45.66033887,45.7336,45.6688584283559,45.7050621120799,46.27238,46.28649,46.28086,46.2741,46.269109],[14.43701769,14.43701769,14.43701769,14.2825,14.3470930449133,14.3851990899332,14.08331,14.05114,14.109593,14.02601,14.010106],2,null,"Mother Movement",{"interactive":true,"className":"","stroke":true,"color":"#b7484b","weight":5,"opacity":0.5,"fill":true,"fillColor":"#b7484b","fillOpacity":0.2},null,null,["Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>"],null,["M273P","M273P","M273P","M28LU","M28LU","M28LU","M28TU","M28TU","M28TU","M28TU","M28TU"],{"interactive":false,"permanent":true,"direction":"auto","opacity":1,"offset":[12,12,12,12],"textsize":"10px","textOnly":true,"style":{"color":"black"},"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[45.718038,46.28649,45.7336,45.71180359,45.70079,45.7325,46.2568,45.70127136,45.720399,45.61513725,45.760654,45.62896,45.6896188345578,46.287004,45.65127727,45.710773,45.700402,45.705071,45.71478359,45.8851846226527,46.28701,46.28697,46.287116,45.6330119540741,45.6510452415827,45.6505586873457,45.6689310520974,45.7065841227858,45.6598609247567,45.6598609247567,45.641791878403,46.268311,45.7027319937245,45.67861894],[14.143187,14.05114,14.2825,14.8960214,14.12438,14.2859,14.0514,14.17125995,14.091525,14.49559434,14.082712,14.48918,14.155279974819,14.055054,14.42427833,14.09304,14.124478,14.147291,14.07232147,14.2921977743998,14.05499,14.05487,14.06162,14.3731614196494,14.2865104768958,14.2959857103721,14.3599263962589,14.1509023986607,14.3471976329859,14.3471976329859,14.3345795219718,14.068722,14.6898441384208,14.24350475],3,null,"Offspring Reference",{"interactive":true,"className":"","stroke":true,"color":"orange","weight":5,"opacity":0.5,"fill":true,"fillColor":"orange","fillOpacity":0.2},null,null,["Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>"],null,["M1J47","M2772","M28LU","M2ALK","M2F1L","MSV00E","MSV0AL","MSV0FK","MSV0H5","MSV0M6","MSV0P7","MSV0UL","MSV0UP","MSV0XT","MSV10T","MSV16T","MSV16U","MSV170","MSV177","MSV17F","MSV17U","MSV180","MSV18C","MSV1C0","MSV1EX","MSV1F5","MSV1F8","MSV1FE","MSV1FJ","MSV1FL","MSV1FT","MSV1KT","MSV1MH","MSV1TM"],{"interactive":false,"permanent":false,"direction":"auto","opacity":0.5,"offset":[12,12,12,12],"textsize":"3px","textOnly":true,"style":{"color":"gray"},"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[45.718038,45.670475810594,46.28649,45.7336,45.6688584283559,45.7050621120799,45.71180359,45.70079,45.6991450895825,45.7325,45.7347,45.6688584283559,45.6119282093501,45.6089963126655,45.6961329625972,45.7023899126724,45.7032709493347,45.6975587325296,45.6869260613992,45.6957767180808,45.6869260613992,45.6330119540741,46.2568,46.27054,46.28086,46.276408,46.28024,45.70127136,45.7120392032366,45.74607682,45.7016291148152,45.7019790581476,45.720399,45.7496102776277,45.7496102776277,45.7034974390543,45.61513725,45.733886,45.729182651856,45.9315200573405,45.9011121440888,45.90041,45.90041,45.9023,45.760654,45.62896,45.62896,45.6896188345578,46.287004,46.28701,46.28318,45.65127727,45.65127727,45.710773,45.700402,45.705071,45.696231,45.725409,45.68903,45.71478359,45.8851846226527,45.90737,45.92104,46.28701,46.286387,46.27558,46.28697,46.287116,45.6330119540741,45.6598609247567,45.6507893877327,45.6873317850781,45.6290472846108,45.6510452415827,45.6505586873457,45.6689310520974,45.7065841227858,45.6598609247567,45.6420095457388,45.7050621120799,45.6598609247567,45.641791878403,45.6507893877327,46.268311,46.2566828222476,45.7027319937245,45.66457,45.5716253435768,45.67861894],[14.143187,14.0936137013246,14.05114,14.2825,14.3470930449133,14.3851990899332,14.8960214,14.12438,14.1671692149873,14.2859,14.2819,14.3470930449133,14.3419067953084,14.3548386845148,14.3981373650013,14.3826631157154,14.3791860255052,14.39804827173,14.3597211851049,14.3339395093881,14.3597211851049,14.3731614196494,14.0514,14.06499,14.109593,14.076625,14.08025,14.17125995,14.1062629866199,14.30873331,14.1746963191694,14.1758084376361,14.091525,14.0918606805297,14.0918606805297,14.105949346749,14.49559434,14.529163,14.5232755277233,14.2843503029741,14.332889086099,14.34455,14.32964,14.33427,14.082712,14.48918,14.48918,14.155279974819,14.055054,14.05501,14.04873,14.42427833,14.42427833,14.09304,14.124478,14.147291,14.163826,14.087656,14.142549,14.07232147,14.2921977743998,14.27999,14.28296,14.05499,14.05741,14.08261,14.05487,14.06162,14.3731614196494,14.3471976329859,14.3344729795253,14.4367469632264,14.3949065673671,14.2865104768958,14.2959857103721,14.3599263962589,14.1509023986607,14.3471976329859,14.3730610851272,14.3851990899332,14.3471976329859,14.3345795219718,14.3344729795253,14.068722,14.0350311085623,14.6898441384208,14.71755,14.8350767952159,14.24350475],1,null,"Offspring Movement",{"interactive":true,"className":"","stroke":true,"color":"black","weight":5,"opacity":0.5,"fill":true,"fillColor":"black","fillOpacity":0.2},null,null,["Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: M <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>","Sex: F <br>"],null,["M1J47","M1J47","M2772","M28LU","M28LU","M28LU","M2ALK","M2F1L","M2F1L","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV00E","MSV0AL","MSV0AL","MSV0AL","MSV0AL","MSV0AL","MSV0FK","MSV0FK","MSV0FK","MSV0FK","MSV0FK","MSV0H5","MSV0H5","MSV0H5","MSV0H5","MSV0M6","MSV0M6","MSV0M6","MSV0M6","MSV0M6","MSV0M6","MSV0M6","MSV0M6","MSV0P7","MSV0UL","MSV0UL","MSV0UP","MSV0XT","MSV0XT","MSV0XT","MSV10T","MSV10T","MSV16T","MSV16U","MSV170","MSV170","MSV170","MSV170","MSV177","MSV17F","MSV17F","MSV17F","MSV17U","MSV17U","MSV17U","MSV180","MSV18C","MSV1C0","MSV1C0","MSV1C0","MSV1C0","MSV1C0","MSV1EX","MSV1F5","MSV1F8","MSV1FE","MSV1FJ","MSV1FJ","MSV1FJ","MSV1FL","MSV1FT","MSV1FT","MSV1KT","MSV1KT","MSV1MH","MSV1MH","MSV1MH","MSV1TM"],{"interactive":false,"permanent":false,"direction":"auto","opacity":0.5,"offset":[12,12,12,12],"textsize":"3px","textOnly":true,"style":{"color":"gray"},"className":"","sticky":true},null]},{"method":"addPolylines","args":[[[[{"lng":[14.43701769,14.8960214],"lat":[45.66033887,45.71180359]}]],[[{"lng":[14.43701769,14.2859],"lat":[45.66033887,45.7325]}]],[[{"lng":[14.010106,14.0514],"lat":[46.269109,46.2568]}]],[[{"lng":[14.43701769,14.49559434],"lat":[45.66033887,45.61513725]}]],[[{"lng":[14.43701769,14.48918],"lat":[45.66033887,45.62896]}]],[[{"lng":[14.010106,14.055054],"lat":[46.269109,46.287004]}]],[[{"lng":[14.3851990899332,14.42427833],"lat":[45.7050621120799,45.65127727]}]],[[{"lng":[14.43701769,14.2921977743998],"lat":[45.66033887,45.8851846226527]}]],[[{"lng":[14.010106,14.05499],"lat":[46.269109,46.28701]}]],[[{"lng":[14.010106,14.05487],"lat":[46.269109,46.28697]}]],[[{"lng":[14.010106,14.06162],"lat":[46.269109,46.287116]}]],[[{"lng":[14.3851990899332,14.3731614196494],"lat":[45.7050621120799,45.6330119540741]}]],[[{"lng":[14.3851990899332,14.2865104768958],"lat":[45.7050621120799,45.6510452415827]}]],[[{"lng":[14.3851990899332,14.2959857103721],"lat":[45.7050621120799,45.6505586873457]}]],[[{"lng":[14.3851990899332,14.3599263962589],"lat":[45.7050621120799,45.6689310520974]}]],[[{"lng":[14.3851990899332,14.3471976329859],"lat":[45.7050621120799,45.6598609247567]}]],[[{"lng":[14.3851990899332,14.3471976329859],"lat":[45.7050621120799,45.6598609247567]}]],[[{"lng":[14.3851990899332,14.3345795219718],"lat":[45.7050621120799,45.641791878403]}]],[[{"lng":[14.010106,14.068722],"lat":[46.269109,46.268311]}]],[[{"lng":[14.43701769,14.6898441384208],"lat":[45.66033887,45.7027319937245]}]],[[{"lng":[14.3851990899332,14.24350475],"lat":[45.7050621120799,45.67861894]}]]],null,"Maternity",{"interactive":true,"className":"","stroke":true,"color":"#b7484b","weight":1.5,"opacity":1,"fill":false,"fillColor":"#b7484b","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolylines","args":[[[[{"lng":[14.1965906256871,14.143187],"lat":[45.593778082641,45.718038]}]],[[{"lng":[14.49858,14.8960214],"lat":[45.60573,45.71180359]}]],[[{"lng":[14.1965906256871,14.12438],"lat":[45.593778082641,45.70079]}]],[[{"lng":[14.49858,14.2859],"lat":[45.60573,45.7325]}]],[[{"lng":[14.05114,14.0514],"lat":[46.28649,46.2568]}]],[[{"lng":[14.1965906256871,14.17125995],"lat":[45.593778082641,45.70127136]}]],[[{"lng":[14.1965906256871,14.091525],"lat":[45.593778082641,45.720399]}]],[[{"lng":[14.49858,14.49559434],"lat":[45.60573,45.61513725]}]],[[{"lng":[14.1965906256871,14.082712],"lat":[45.593778082641,45.760654]}]],[[{"lng":[14.49858,14.48918],"lat":[45.60573,45.62896]}]],[[{"lng":[14.1965906256871,14.155279974819],"lat":[45.593778082641,45.6896188345578]}]],[[{"lng":[14.05114,14.055054],"lat":[46.28649,46.287004]}]],[[{"lng":[14.3731614196494,14.42427833],"lat":[45.6330119540741,45.65127727]}]],[[{"lng":[14.1965906256871,14.09304],"lat":[45.593778082641,45.710773]}]],[[{"lng":[14.1965906256871,14.124478],"lat":[45.593778082641,45.700402]}]],[[{"lng":[14.1965906256871,14.147291],"lat":[45.593778082641,45.705071]}]],[[{"lng":[14.1965906256871,14.07232147],"lat":[45.593778082641,45.71478359]}]],[[{"lng":[14.49858,14.2921977743998],"lat":[45.60573,45.8851846226527]}]],[[{"lng":[14.05114,14.05499],"lat":[46.28649,46.28701]}]],[[{"lng":[14.05114,14.05487],"lat":[46.28649,46.28697]}]],[[{"lng":[14.05114,14.06162],"lat":[46.28649,46.287116]}]],[[{"lng":[14.3731614196494,14.3731614196494],"lat":[45.6330119540741,45.6330119540741]}]],[[{"lng":[14.3731614196494,14.2865104768958],"lat":[45.6330119540741,45.6510452415827]}]],[[{"lng":[14.3731614196494,14.2959857103721],"lat":[45.6330119540741,45.6505586873457]}]],[[{"lng":[14.3731614196494,14.3599263962589],"lat":[45.6330119540741,45.6689310520974]}]],[[{"lng":[14.1965906256871,14.1509023986607],"lat":[45.593778082641,45.7065841227858]}]],[[{"lng":[14.3731614196494,14.3471976329859],"lat":[45.6330119540741,45.6598609247567]}]],[[{"lng":[14.3731614196494,14.3471976329859],"lat":[45.6330119540741,45.6598609247567]}]],[[{"lng":[14.3731614196494,14.3345795219718],"lat":[45.6330119540741,45.641791878403]}]],[[{"lng":[14.05114,14.068722],"lat":[46.28649,46.268311]}]],[[{"lng":[14.49858,14.6898441384208],"lat":[45.60573,45.7027319937245]}]],[[{"lng":[14.3731614196494,14.24350475],"lat":[45.6330119540741,45.67861894]}]]],null,"Paternity",{"interactive":true,"className":"","stroke":true,"color":"#1f78b4","weight":1.5,"opacity":1,"fill":false,"fillColor":"#1f78b4","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolylines","args":[[[[{"lng":[14.49858,14.49858,14.49858],"lat":[45.60573,45.60573,45.60573]}]],[[{"lng":[14.08487618,14.1147190955103,14.1323574857189,14.1482015808661,14.1965906256871],"lat":[45.70894581,45.7190875187433,45.7123749129673,45.7025958430667,45.593778082641]}]],[[{"lng":[14.2859,14.2819,14.3470930449133,14.3419067953084,14.3548386845148,14.3981373650013,14.3826631157154,14.3791860255052,14.39804827173,14.3597211851049,14.3339395093881,14.3597211851049,14.3731614196494],"lat":[45.7325,45.7347,45.6688584283559,45.6119282093501,45.6089963126655,45.6961329625972,45.7023899126724,45.7032709493347,45.6975587325296,45.6869260613992,45.6957767180808,45.6869260613992,45.6330119540741]}]]],null,"Father Movement Line",{"interactive":true,"className":"","stroke":true,"color":"#1f78b4","weight":0.5,"opacity":0.4,"fill":false,"fillColor":"#1f78b4","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolylines","args":[[[[{"lng":[14.143187,14.0936137013246],"lat":[45.718038,45.670475810594]}]],[[{"lng":[14.2825,14.3470930449133,14.3851990899332],"lat":[45.7336,45.6688584283559,45.7050621120799]}]],[[{"lng":[14.12438,14.1671692149873],"lat":[45.70079,45.6991450895825]}]],[[{"lng":[14.2859,14.2819,14.3470930449133,14.3419067953084,14.3548386845148,14.3981373650013,14.3826631157154,14.3791860255052,14.39804827173,14.3597211851049,14.3339395093881,14.3597211851049,14.3731614196494],"lat":[45.7325,45.7347,45.6688584283559,45.6119282093501,45.6089963126655,45.6961329625972,45.7023899126724,45.7032709493347,45.6975587325296,45.6869260613992,45.6957767180808,45.6869260613992,45.6330119540741]}]],[[{"lng":[14.0514,14.06499,14.109593,14.076625,14.08025],"lat":[46.2568,46.27054,46.28086,46.276408,46.28024]}]],[[{"lng":[14.17125995,14.1062629866199,14.30873331,14.1746963191694,14.1758084376361],"lat":[45.70127136,45.7120392032366,45.74607682,45.7016291148152,45.7019790581476]}]],[[{"lng":[14.091525,14.0918606805297,14.0918606805297,14.105949346749],"lat":[45.720399,45.7496102776277,45.7496102776277,45.7034974390543]}]],[[{"lng":[14.49559434,14.529163,14.5232755277233,14.2843503029741,14.332889086099,14.34455,14.32964,14.33427],"lat":[45.61513725,45.733886,45.729182651856,45.9315200573405,45.9011121440888,45.90041,45.90041,45.9023]}]],[[{"lng":[14.48918,14.48918],"lat":[45.62896,45.62896]}]],[[{"lng":[14.055054,14.05501,14.04873],"lat":[46.287004,46.28701,46.28318]}]],[[{"lng":[14.42427833,14.42427833],"lat":[45.65127727,45.65127727]}]],[[{"lng":[14.147291,14.163826,14.087656,14.142549],"lat":[45.705071,45.696231,45.725409,45.68903]}]],[[{"lng":[14.2921977743998,14.27999,14.28296],"lat":[45.8851846226527,45.90737,45.92104]}]],[[{"lng":[14.05499,14.05741,14.08261],"lat":[46.28701,46.286387,46.27558]}]],[[{"lng":[14.3731614196494,14.3471976329859,14.3344729795253,14.4367469632264,14.3949065673671],"lat":[45.6330119540741,45.6598609247567,45.6507893877327,45.6873317850781,45.6290472846108]}]],[[{"lng":[14.3471976329859,14.3730610851272,14.3851990899332],"lat":[45.6598609247567,45.6420095457388,45.7050621120799]}]],[[{"lng":[14.3345795219718,14.3344729795253],"lat":[45.641791878403,45.6507893877327]}]],[[{"lng":[14.068722,14.0350311085623],"lat":[46.268311,46.2566828222476]}]],[[{"lng":[14.6898441384208,14.71755,14.8350767952159],"lat":[45.7027319937245,45.66457,45.5716253435768]}]]],null,"Offspring Movement Line",{"interactive":true,"className":"","stroke":true,"color":"black","weight":0.5,"opacity":0.4,"fill":false,"fillColor":"black","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[[],["Father Reference","Father Movemet","Mother Reference","Mother Movement","Offspring Reference","Offspring Movement","Maternity","Paternity","Father Movement Line","Mother Movement Line","Offspring Movement Line"],{"collapsed":false,"autoZIndex":true,"position":"topright"}]},{"method":"hideGroup","args":[["Father Movemet","Mother Movement","Offspring Movement","Maternity","Paternity","Father Movement Line","Mother Movement Line","Offspring Movement Line"]]}],"limits":{"lat":[45.5716253435768,46.287116],"lng":[14.010106,14.8960214]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level4">
<h4 id="gis-output">GIS output<a class="anchor" aria-label="anchor" href="#gis-output"></a>
</h4>
<p>As described above the default output of the
<code>ped_spatila()</code> function is a list of <code>sf</code> objects
that can be further analyzed and visualized using R packages that enable
visual representation of geographic datasets such as <a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a> and <a href="https://r-spatial.github.io/mapview/" class="external-link">mapview</a>.</p>
<p>To extend the possibilities of spatial analysis and visualization
outside of R, <code><a href="../reference/ped_spatial.html">ped_spatial()</a></code>provides the flexibility for
users to export the spatial data in formats compatible with Geographic
Information System (GIS) software. By specifying the <code>"gis"</code>
value for the <em>output</em> parameter and defining a folder path in
the <em>path</em> parameter, users can store the georeferenced files in
the designated folder. This allows for seamless integration and
utilization of the pedigree data with GIS software, unlocking a wide
range of spatial analysis capabilities and visualization options.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>pt <span class="ot">&lt;-</span> <span class="fu">plot_table</span>(</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="at">plot_fams =</span> <span class="dv">1</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="at">all_fams =</span> fams_org,</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  <span class="at">ped =</span> ped_org,</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  <span class="at">sampledata =</span> sampledata,</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="at">deadSample =</span> <span class="fu">c</span>(<span class="st">"Tissue"</span>, <span class="st">"Decomposing Tissue"</span>, <span class="st">"Blood"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">ped_spatial</span>(</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="at">plottable =</span> pt,</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"gis"</span>,</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"/folder/where/GIS/files/shuld/be/saved/"</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>)</span></code></pre></div>
<p>The created GIS files follow the same structure as described above,
just the output file names are different:</p>
<table class="table">
<thead><tr class="header">
<th align="center">sf object</th>
<th align="center">file name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">motherRpoints</td>
<td align="center">momRef</td>
</tr>
<tr class="even">
<td align="center">fatherRpoints</td>
<td align="center">dadRef</td>
</tr>
<tr class="odd">
<td align="center">offspringRpoints</td>
<td align="center">ofsprRef</td>
</tr>
<tr class="even">
<td align="center">motherMovePoints</td>
<td align="center">momMovPt</td>
</tr>
<tr class="odd">
<td align="center">fatherMovePoints</td>
<td align="center">dadMovPt</td>
</tr>
<tr class="even">
<td align="center">offspringMovePoints</td>
<td align="center">offsprMovPt</td>
</tr>
<tr class="odd">
<td align="center">maternityLines</td>
<td align="center">matLn</td>
</tr>
<tr class="even">
<td align="center">paternityLines</td>
<td align="center">patLn</td>
</tr>
<tr class="odd">
<td align="center">motherMoveLines</td>
<td align="center">momMovLn</td>
</tr>
<tr class="even">
<td align="center">fatherMoveLines</td>
<td align="center">dadMovLn</td>
</tr>
<tr class="odd">
<td align="center">offspringMoveLines</td>
<td align="center">offsprMovLn</td>
</tr>
<tr class="even">
<td align="center">motherMovePolygons</td>
<td align="center">momMovPoly</td>
</tr>
<tr class="odd">
<td align="center">fatherMovePolygons</td>
<td align="center">dadMovPoly</td>
</tr>
<tr class="even">
<td align="center">offspringMovePolygons</td>
<td align="center">offsMovPoly</td>
</tr>
<tr class="odd">
<td align="center">FullsibLines</td>
<td align="center">FsLines</td>
</tr>
</tbody>
</table>
<p>To distinguish or avoid overwriting of generated files, the parameter
<em>filename</em> can be used. The string specified with this parameter
acts as a common name for all the files generated. When generating GIS
files the all the other function parameters can be used as described in
the beginning of this chapter (eg. <em>fullsibdata</em>,
<em>time.limits</em>). <br></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="outside-of-the-workflow">Outside of the workflow<a class="anchor" aria-label="anchor" href="#outside-of-the-workflow"></a>
</h2>
<p>Besides the functions that facilitate the visualization and analysis
of pedigree data in temporal and spatial dimensions, the
<strong>wpeR</strong> package currently provides an additional function
designed to aid in the calculation and representation of detected
animals across multiple time periods. This functions works just with
sample metadata and can be used independently of the workflow described
in previous chapter.</p>
<p>To calculate the number of captured animals between two or more time
periods the function <code><a href="../reference/nbtw_seasons.html">nbtw_seasons()</a></code> is used. The function
takes four parameters the first two: <em>animal_id</em> and
<em>capture_date</em> correspond to AnimalRef and Date column in the
same meta data table, respectively. The other two are vectors in ´Date´
format one corresponding to start and the other to end of the time
periods of interest. It is worth noting that the function refers to
these time periods as “seasons” in its terminology.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seasons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2017-01-01"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2018-01-01"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-01-01"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2017-12-31"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2018-12-31"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-12-31"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dyn_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dyn_matrix.html">dyn_matrix</a></span><span class="op">(</span></span>
<span>  animal_id <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">AnimalRef</span>,</span>
<span>  capture_date <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">Date</span>,</span>
<span>  start_dates <span class="op">=</span> <span class="va">seasons</span><span class="op">$</span><span class="va">start</span>,</span>
<span>  end_dates <span class="op">=</span> <span class="va">seasons</span><span class="op">$</span><span class="va">end</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">dyn_mat</span></span>
<span><span class="co">#&gt;                         2017-01-01 - 2017-12-31 2018-01-01 - 2018-12-31</span></span>
<span><span class="co">#&gt; 2017-01-01 - 2017-12-31                      13                       8</span></span>
<span><span class="co">#&gt; 2018-01-01 - 2018-12-31                       2                       4</span></span>
<span><span class="co">#&gt; 2019-01-01 - 2019-12-31                       0                       0</span></span>
<span><span class="co">#&gt; Tot. Skipped                                  0                       2</span></span>
<span><span class="co">#&gt;                         2019-01-01 - 2019-12-31 Tot. Capts</span></span>
<span><span class="co">#&gt; 2017-01-01 - 2017-12-31                       6         13</span></span>
<span><span class="co">#&gt; 2018-01-01 - 2018-12-31                       6         12</span></span>
<span><span class="co">#&gt; 2019-01-01 - 2019-12-31                      17         25</span></span>
<span><span class="co">#&gt; Tot. Skipped                                  0         NA</span></span></code></pre></div>
<p>The function outputs a matrix with 1 + no. of time periods rows and
columns explaining the dynamics of animal deception between included
time periods. It conveys the information on all detected animals, newly
detected animals, recaptured animals and skipped animals. For the
purpose a more detailed explanation, we will drop the row and column
names.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">dyn_mat</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]   13    8    6   13</span></span>
<span><span class="co">#&gt; [2,]    2    4    6   12</span></span>
<span><span class="co">#&gt; [3,]    0    0   17   25</span></span>
<span><span class="co">#&gt; [4,]    0    2    0   NA</span></span></code></pre></div>
<p>In the matrix presented above:</p>
<ul>
<li>Column and row 4 correspond to the number of captured and number of
skipped animals in the particular time period.</li>
<li>The <strong>diagonal</strong> gives number of new detection in each
time period.</li>
<li>Numbers <strong>above diagonal</strong> correspond to the number of
re-detected (recaptured) animals in time period x (column names)
compared to time period y (row names).</li>
<li>Numbers <strong>below diagonal</strong> correspond to the number of
animals from time period y that were skipped in time period x.</li>
</ul>
<p><strong>JUST TWO TIME PERIODS</strong> <br> To get the animal
detection dynamics between just two time periods
<code><a href="../reference/nbtw_seasons.html">nbtw_seasons()</a></code> function can be called. This function
provides a simple output representing a detection dynamics between two
time periods. The function takes six parameters. First two are the same
as described above. The other parameters correspond to strings in
<code>Date</code> format defining the start and end of time periods of
interest.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nbtw_seasons.html">nbtw_seasons</a></span><span class="op">(</span></span>
<span> animal_id <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">AnimalRef</span>,</span>
<span> capture_date <span class="op">=</span> <span class="va">wolf_samples</span><span class="op">$</span><span class="va">Date</span>,</span>
<span> season1_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2017-01-01"</span><span class="op">)</span>,</span>
<span> season1_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2017-12-31"</span><span class="op">)</span>,</span>
<span> season2_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2018-01-01"</span><span class="op">)</span>,</span>
<span> season2_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2018-12-31"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;                   season1                 season2 total_cap new_captures</span></span>
<span><span class="co">#&gt; 1 2017-01-01 - 2017-12-31 2018-01-01 - 2018-12-31        12            4</span></span>
<span><span class="co">#&gt;   recaptures skipped</span></span>
<span><span class="co">#&gt; 1          8       2</span></span></code></pre></div>
<p>The returned data frame first defines the two time periods and than
gives five values describing the detection of animals.
<code>total_cap</code> gives the number of detected animal in season 2,
<code>new_captures</code> corresponds to the number of new detection in
season 2, <code>recaptured</code> to the number of animals detected in
season 1 and in season 2 and <code>skipped</code> just the opposite,
number of animals detected in season 1 but not in season 2.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tomaz Skrbinsek, Gregor Simcic.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
